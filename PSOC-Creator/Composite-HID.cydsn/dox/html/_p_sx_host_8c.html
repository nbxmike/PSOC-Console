<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSOC Joystick: Source/PSxHost.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSOC Joystick
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_sx_host_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">PSxHost.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The host side interface of a PlayStation 1/2 controller.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;project.h&gt;</code><br />
<code>#include &quot;FreeRTOS.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_p_sx_host_8h_source.html">PSxHost.h</a>&quot;</code><br />
<code>#include &quot;timers.h&quot;</code><br />
<code>#include &quot;semphr.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_r_support_8h_source.html">FRSupport.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6d92f04ca991ad6b0e0978edd04ea5bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a6d92f04ca991ad6b0e0978edd04ea5bf">PSx_ACK_isr_Interrupt_InterruptCallback</a> (void)</td></tr>
<tr class="memdesc:a6d92f04ca991ad6b0e0978edd04ea5bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ISR handler for the ACK signal from the PSx game controller.  <a href="#a6d92f04ca991ad6b0e0978edd04ea5bf">More...</a><br /></td></tr>
<tr class="separator:a6d92f04ca991ad6b0e0978edd04ea5bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5792d317db575ac0e27d34405daa42ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a5792d317db575ac0e27d34405daa42ea">Delay_10uS_isr_Interrupt_InterruptCallback</a> (void)</td></tr>
<tr class="memdesc:a5792d317db575ac0e27d34405daa42ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ISR handler for the timeout of the ACK signal.  <a href="#a5792d317db575ac0e27d34405daa42ea">More...</a><br /></td></tr>
<tr class="separator:a5792d317db575ac0e27d34405daa42ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcc4b6f1b780c52740062e56bc2f039b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#abcc4b6f1b780c52740062e56bc2f039b">PSx_SPI_RX_ISR_ExitCallback</a> (void)</td></tr>
<tr class="memdesc:abcc4b6f1b780c52740062e56bc2f039b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ISR handler for the receive from the PSx game controller.  <a href="#abcc4b6f1b780c52740062e56bc2f039b">More...</a><br /></td></tr>
<tr class="separator:abcc4b6f1b780c52740062e56bc2f039b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a65472f5ec3894fd79442f217aef95b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a4a65472f5ec3894fd79442f217aef95b">PSxTrasnferByte</a> (uint8 Out, uint8 *In, int Wait)</td></tr>
<tr class="memdesc:a4a65472f5ec3894fd79442f217aef95b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends and receives a single byte to/from the PSx controller.  <a href="#a4a65472f5ec3894fd79442f217aef95b">More...</a><br /></td></tr>
<tr class="separator:a4a65472f5ec3894fd79442f217aef95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4eaf2ecdfbb23b74dba1058d24efde5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#ac4eaf2ecdfbb23b74dba1058d24efde5">PSxTrasnferString</a> (uint8 *Out, uint8 *In, int count, int Wait)</td></tr>
<tr class="memdesc:ac4eaf2ecdfbb23b74dba1058d24efde5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends and receives a string of bytes to/from the PSx controller.  <a href="#ac4eaf2ecdfbb23b74dba1058d24efde5">More...</a><br /></td></tr>
<tr class="separator:ac4eaf2ecdfbb23b74dba1058d24efde5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5150dd488a9c2210669dfa4545011fb1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a5150dd488a9c2210669dfa4545011fb1">PSxEnPressure</a> (int button)</td></tr>
<tr class="memdesc:a5150dd488a9c2210669dfa4545011fb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a packet to enable pressure reporting for a button.  <a href="#a5150dd488a9c2210669dfa4545011fb1">More...</a><br /></td></tr>
<tr class="separator:a5150dd488a9c2210669dfa4545011fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a085786ee1b84a8f7d5370d26e97f0935"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a085786ee1b84a8f7d5370d26e97f0935">PSxMotorPoll</a> (int Motor0, int Motor1)</td></tr>
<tr class="memdesc:a085786ee1b84a8f7d5370d26e97f0935"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the analog and button data and sends the vibration motor levels.  <a href="#a085786ee1b84a8f7d5370d26e97f0935">More...</a><br /></td></tr>
<tr class="separator:a085786ee1b84a8f7d5370d26e97f0935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade3c2149682e09f56ba8fcbb66a4723a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#ade3c2149682e09f56ba8fcbb66a4723a">PSxConfigPoll</a> (int CfgByte)</td></tr>
<tr class="memdesc:ade3c2149682e09f56ba8fcbb66a4723a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the analog and button data and enter or exits configuration.  <a href="#ade3c2149682e09f56ba8fcbb66a4723a">More...</a><br /></td></tr>
<tr class="separator:ade3c2149682e09f56ba8fcbb66a4723a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1c2d6d4df27d8b03633f987391d74b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#af1c2d6d4df27d8b03633f987391d74b7">PSxGetModel</a> (void)</td></tr>
<tr class="memdesc:af1c2d6d4df27d8b03633f987391d74b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the controller type and actuator data.  <a href="#af1c2d6d4df27d8b03633f987391d74b7">More...</a><br /></td></tr>
<tr class="separator:af1c2d6d4df27d8b03633f987391d74b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d712b74166d80578d8710194a36992"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#ad4d712b74166d80578d8710194a36992">PSxReset</a> (int length)</td></tr>
<tr class="memdesc:ad4d712b74166d80578d8710194a36992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a messages to the game controller to reset it.  <a href="#ad4d712b74166d80578d8710194a36992">More...</a><br /></td></tr>
<tr class="separator:ad4d712b74166d80578d8710194a36992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5844362104633cb285941ff436499626"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a5844362104633cb285941ff436499626">PSxGetCtlrType</a> (void)</td></tr>
<tr class="memdesc:a5844362104633cb285941ff436499626"><td class="mdescLeft">&#160;</td><td class="mdescRight">PSxGetCtlrType determine what type of controller is present, if any.  <a href="#a5844362104633cb285941ff436499626">More...</a><br /></td></tr>
<tr class="separator:a5844362104633cb285941ff436499626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a38e0d0429c608c26989f08bce3ed8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a30a38e0d0429c608c26989f08bce3ed8">PSxSetup</a> (void)</td></tr>
<tr class="memdesc:a30a38e0d0429c608c26989f08bce3ed8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the system to talk to the PSx game controller.  <a href="#a30a38e0d0429c608c26989f08bce3ed8">More...</a><br /></td></tr>
<tr class="separator:a30a38e0d0429c608c26989f08bce3ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae953a5bc72904a320c27845f9fb55588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#ae953a5bc72904a320c27845f9fb55588">PSxInit</a> (void)</td></tr>
<tr class="memdesc:ae953a5bc72904a320c27845f9fb55588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Intialization of the PSx game controller - one time only.  <a href="#ae953a5bc72904a320c27845f9fb55588">More...</a><br /></td></tr>
<tr class="separator:ae953a5bc72904a320c27845f9fb55588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f5ac0a07c3ae5b59854200357ede1cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a0f5ac0a07c3ae5b59854200357ede1cd">PSx_Host_Task</a> (void *arg)</td></tr>
<tr class="separator:a0f5ac0a07c3ae5b59854200357ede1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1f64fd9d266da8325ade590c3a2ca8a7"><td class="memItemLeft" align="right" valign="top">uint8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a1f64fd9d266da8325ade590c3a2ca8a7">PSxOutBuffer</a> [<a class="el" href="_p_sx_host_8h.html#a6893e51b9fa04e47eae2355bc7fa8a26">PSx_MAX_MESSAGE</a>]</td></tr>
<tr class="separator:a1f64fd9d266da8325ade590c3a2ca8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88db31a59e4b525c9c8f4d1d407d997"><td class="memItemLeft" align="right" valign="top">uint8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#af88db31a59e4b525c9c8f4d1d407d997">PSxInBuffer</a> [<a class="el" href="_p_sx_host_8h.html#a6893e51b9fa04e47eae2355bc7fa8a26">PSx_MAX_MESSAGE</a>]</td></tr>
<tr class="separator:af88db31a59e4b525c9c8f4d1d407d997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80db7bca742e1886e73e06edd1bf5426"><td class="memItemLeft" align="right" valign="top">uint8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a80db7bca742e1886e73e06edd1bf5426">PSxXfrBuffer</a> [<a class="el" href="_p_sx_host_8h.html#a6893e51b9fa04e47eae2355bc7fa8a26">PSx_MAX_MESSAGE</a>]</td></tr>
<tr class="separator:a80db7bca742e1886e73e06edd1bf5426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e868d7b04d036a0a50a20293612edc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#a4e868d7b04d036a0a50a20293612edc5">Feedback0</a></td></tr>
<tr class="separator:a4e868d7b04d036a0a50a20293612edc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea34c570c26750610b966e142539cd7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_sx_host_8c.html#adea34c570c26750610b966e142539cd7">Feedback1</a></td></tr>
<tr class="separator:adea34c570c26750610b966e142539cd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The host side interface of a PlayStation 1/2 controller. </p>
<dl class="section author"><dt>Author</dt><dd>Mike McCormack (nbxmike) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8/OCT/2018 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5792d317db575ac0e27d34405daa42ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5792d317db575ac0e27d34405daa42ea">&#9670;&nbsp;</a></span>Delay_10uS_isr_Interrupt_InterruptCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Delay_10uS_isr_Interrupt_InterruptCallback </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ISR handler for the timeout of the ACK signal. </p>
<p>Will give the semaphore to the foreground related to waiting for an ACK from the PSx game controller if the timeout period has expired. The foreground must check what caused the ACK wait to release, this timeout or an actual ACK. Checks to ensure the semaphore has been created but really should not be called until the semaphore does exist. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None,ISR</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None, ISR. It does release the foreground semaphore. </dd></dl>

</div>
</div>
<a id="a6d92f04ca991ad6b0e0978edd04ea5bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d92f04ca991ad6b0e0978edd04ea5bf">&#9670;&nbsp;</a></span>PSx_ACK_isr_Interrupt_InterruptCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSx_ACK_isr_Interrupt_InterruptCallback </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ISR handler for the ACK signal from the PSx game controller. </p>
<p>Will give the semaphore to the foreground related to waiting for an ACK from the PSx game controller. Since the ACK timeout function releases the same semaphore, the foreground must check that ACK was actaully sent to the host by the game controller. This checks to ensure the semaphore has been created but really should not be called until the semaphore does exist. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None,ISR</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None, ISR. It does release the foreground semaphore. </dd></dl>

</div>
</div>
<a id="a0f5ac0a07c3ae5b59854200357ede1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f5ac0a07c3ae5b59854200357ede1cd">&#9670;&nbsp;</a></span>PSx_Host_Task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSx_Host_Task </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abcc4b6f1b780c52740062e56bc2f039b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcc4b6f1b780c52740062e56bc2f039b">&#9670;&nbsp;</a></span>PSx_SPI_RX_ISR_ExitCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSx_SPI_RX_ISR_ExitCallback </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ISR handler for the receive from the PSx game controller. </p>
<p>Will give the semaphore to the foreground related to waiting for an data from the PSx game controller. Checks to ensure the semaphore has been created but really should not be called until the semaphore does exist. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None,ISR</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None, ISR. It does release the foreground semaphore. </dd></dl>

</div>
</div>
<a id="ade3c2149682e09f56ba8fcbb66a4723a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade3c2149682e09f56ba8fcbb66a4723a">&#9670;&nbsp;</a></span>PSxConfigPoll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxConfigPoll </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CfgByte</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the analog and button data and enter or exits configuration. </p>
<p>This sends the configuration/poll command to the game controller if one is attached. Not all controllers support this message so the ACKs from a controller may stop at the second byte of the transfer. Calling routines must check that sufficent bytes were transfered to have entered config mode. Recommend using ENTERCONFIG/EXITCONFIG as the parameter value </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CfgByte</td><td>if zero exits configuration, otherwise enters config. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes ACKed is returned. </dd></dl>

</div>
</div>
<a id="a5150dd488a9c2210669dfa4545011fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5150dd488a9c2210669dfa4545011fb1">&#9670;&nbsp;</a></span>PSxEnPressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxEnPressure </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>button</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a packet to enable pressure reporting for a button. </p>
<p>Some buttons on some PSx controllers can report a value proportional to the amount of pressure that is used to depress the button. This command creates the necessary packet for the button number provided and sends it to the PSx game controller </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">button</td><td>The button number to enable pressure sensing </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the complete packet was ACKed, zero if not. </dd></dl>

</div>
</div>
<a id="a5844362104633cb285941ff436499626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5844362104633cb285941ff436499626">&#9670;&nbsp;</a></span>PSxGetCtlrType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxGetCtlrType </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PSxGetCtlrType determine what type of controller is present, if any. </p>
<p>First, we just poll the controller and use the reply type to set an inital value for the controller type. Then we try to enter config mode, and if that works we try to read the model number. If the game controller answered the initial poll but not the config, we leave the inital guess as the final answer. If we never completed any message, we return NOTPRESENT as the answer. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Controller type </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Presently this also set the global PSxControllerType elements </dd></dl>

</div>
</div>
<a id="af1c2d6d4df27d8b03633f987391d74b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1c2d6d4df27d8b03633f987391d74b7">&#9670;&nbsp;</a></span>PSxGetModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxGetModel </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the controller type and actuator data. </p>
<p>This sends a get model message and if it is successfully received it will fill in elements of the PSxControllerType data structure according to what is received. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes ACKed is returned. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Presently this also set the global PSxControllerType elements </dd></dl>

</div>
</div>
<a id="ae953a5bc72904a320c27845f9fb55588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae953a5bc72904a320c27845f9fb55588">&#9670;&nbsp;</a></span>PSxInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSxInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Intialization of the PSx game controller - one time only. </p>
<p>Sets up the software mainly, the hardware is largely configured in the PSOC TopDesign.cysch file. This is intended to only be called one time and repeat calls could be problematic. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

</div>
</div>
<a id="a085786ee1b84a8f7d5370d26e97f0935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a085786ee1b84a8f7d5370d26e97f0935">&#9670;&nbsp;</a></span>PSxMotorPoll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxMotorPoll </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Motor0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Motor1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the analog and button data and sends the vibration motor levels. </p>
<p>This sends the universally accepted poll command to the game controller if one is attached. For game controllers with "force feedback" the same message also sets the motor speed. At present only two motors are supported might need to expand that at some point. The physical motors are mapped to these logical control bytes by other commands. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Motor0</td><td>Speed parameter for first logical motor. </td></tr>
    <tr><td class="paramname">Motor1</td><td>Speed parameter for second logical motor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes ACKed by the controller (i.e. transfer - 1). </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Not all motors support speed control, some are on/off only. </dd></dl>

</div>
</div>
<a id="ad4d712b74166d80578d8710194a36992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d712b74166d80578d8710194a36992">&#9670;&nbsp;</a></span>PSxReset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSxReset </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a messages to the game controller to reset it. </p>
<p>This will send the 0x01 first byte only message that a real PlayStation sends when it dislikes the game controller it is talking to such as at power up or when one is plugged in later. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lenght</td><td>If length is zero, a 100mS reset is performed, otherwise 1S </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

</div>
</div>
<a id="a30a38e0d0429c608c26989f08bce3ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a38e0d0429c608c26989f08bce3ed8">&#9670;&nbsp;</a></span>PSxSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSxSetup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the system to talk to the PSx game controller. </p>
<p>Sets up the software mainly, the hardware is largely configured in the PSOC TopDesign.cysch file. This does nothing to create/setup the FreeRTOS elements needed to sync physical events to software, it can be called after it has already been called once without problems. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

</div>
</div>
<a id="a4a65472f5ec3894fd79442f217aef95b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a65472f5ec3894fd79442f217aef95b">&#9670;&nbsp;</a></span>PSxTrasnferByte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxTrasnferByte </td>
          <td>(</td>
          <td class="paramtype">uint8&#160;</td>
          <td class="paramname"><em>Out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&#160;</td>
          <td class="paramname"><em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Wait</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends and receives a single byte to/from the PSx controller. </p>
<p>PSxTrasnferByte will send a byte, and since the interface is forced to be full duplex, it will receive a byte. If told to wait for and ACK, it will return a non-zero value if an ACK was received, otherwise it will return zero. Generally speaking, this procedure could use better error handling especially when the dongle handles multiple interfaces errors on one will seriously impact others if nothing is done to clean up error handling. Recommend using the NOWAIT / YESWAIT defined values as the wait parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Out</td><td>The byte to be sent to the PSx game controller </td></tr>
    <tr><td class="paramname">In</td><td>Pointer to where received data from the PSx game controller is stored </td></tr>
    <tr><td class="paramname">Wait</td><td>If non-zero, the function waits for an ACK </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If zero then no ACK or did not wait, nonzero only if ACK received </dd></dl>

</div>
</div>
<a id="ac4eaf2ecdfbb23b74dba1058d24efde5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4eaf2ecdfbb23b74dba1058d24efde5">&#9670;&nbsp;</a></span>PSxTrasnferString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PSxTrasnferString </td>
          <td>(</td>
          <td class="paramtype">uint8 *&#160;</td>
          <td class="paramname"><em>Out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&#160;</td>
          <td class="paramname"><em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Wait</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends and receives a string of bytes to/from the PSx controller. </p>
<p>PSxTrasnferString will send a packet of binary data to the PSx game controller. Since the interface is forced to be full duplex, it will the same number of bytes. If the wait parameter is non-zero, the function will wait until there is an AKC for every byte sent. If the wait parameter is zero, the function will not wait for the final ACK though it will wait for intrabyte ACK. Should ACKs stop at some point, the procedure stops sending. Recommend using YESWAIT and NOWAIT as the wait parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Out</td><td>The byte to be sent to the PSx game controller </td></tr>
    <tr><td class="paramname">In</td><td>Pointer to where received data from the PSx game controller is stored </td></tr>
    <tr><td class="paramname">Wait</td><td>If zero, the function does not wait for the final ACK </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of ACKs received </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If wait is requested, the SS line remains asserted after return </dd>
<dd>
If wait is not requested the packed is ended (i.e. SS is deasserted) </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4e868d7b04d036a0a50a20293612edc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e868d7b04d036a0a50a20293612edc5">&#9670;&nbsp;</a></span>Feedback0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Feedback0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adea34c570c26750610b966e142539cd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea34c570c26750610b966e142539cd7">&#9670;&nbsp;</a></span>Feedback1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Feedback1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af88db31a59e4b525c9c8f4d1d407d997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af88db31a59e4b525c9c8f4d1d407d997">&#9670;&nbsp;</a></span>PSxInBuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8 PSxInBuffer[<a class="el" href="_p_sx_host_8h.html#a6893e51b9fa04e47eae2355bc7fa8a26">PSx_MAX_MESSAGE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1f64fd9d266da8325ade590c3a2ca8a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f64fd9d266da8325ade590c3a2ca8a7">&#9670;&nbsp;</a></span>PSxOutBuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8 PSxOutBuffer[<a class="el" href="_p_sx_host_8h.html#a6893e51b9fa04e47eae2355bc7fa8a26">PSx_MAX_MESSAGE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a80db7bca742e1886e73e06edd1bf5426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80db7bca742e1886e73e06edd1bf5426">&#9670;&nbsp;</a></span>PSxXfrBuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8 PSxXfrBuffer[<a class="el" href="_p_sx_host_8h.html#a6893e51b9fa04e47eae2355bc7fa8a26">PSx_MAX_MESSAGE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="_p_sx_host_8c.html">PSxHost.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
